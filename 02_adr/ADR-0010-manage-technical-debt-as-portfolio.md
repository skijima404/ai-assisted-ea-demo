# ADR-0010: Manage Technical Debt as a Portfolio (技術的負債をポートフォリオとして管理)

## Status
Accepted

## Context

### 問題の背景

現状、技術的負債が「見えないコスト」として蓄積し、システム更新やモダナイゼーションを阻害している。

**技術的負債の蓄積**:
- EOSL問題: OS、MW、DBがすべてEOSLバージョンで、セキュリティパッチが提供されない
- コードの複雑性: 初期開発メンバーが退職し、コードの複雑性により改修が困難
- モノリス構造: コンポーネント間の密結合により、個別のアップグレードが困難

**短期的な納期優先の結果**:
- 初期開発時に割引のユースケースがなく、後から追加する際に設計変更が必要
- コスト削減方針で実装された結果、技術的負債が発生（社食アプリがコンビニ履歴も表示）
- プロジェクト計画段階での決定が後々の柔軟性を失わせている

**技術的負債の可視化の欠如**:
- 技術的負債が定量的に把握されていない
- リスクを伴う投資対象として管理されていない
- 返済（リファクタリングや再設計）の優先順位が不明確

**継続的な改善の困難性**:
- 問題が継続的に発生しているが、根本的な解決策が取られていない
- 「またか」とユーザーが諦めるほど、問題が継続している
- 改善への圧力が弱い

**ビジョンとの関連**:
- アーキテクチャビジョン「3. 柔軟で持続可能なシステム基盤の実現 - 変化に強い仕組み」
- アーキテクチャビジョン「4. 組織と文化の一体的な成長 - 継続的な改善文化の醸成」

## Decision

**「Manage Technical Debt as a Portfolio (技術的負債をポートフォリオとして管理)」原則を採用する**

技術的負債を「見えないコスト」ではなく、リスクを伴う投資対象としてポートフォリオ管理する。発生を抑制するだけでなく、適切に可視化・評価・優先順位付けを行い、組織として意思決定可能な状態を維持する。

### 実装への影響（Implications）
- 技術的負債を定期的に棚卸しし、種類（コード、アーキテクチャ、プロセスなど）と影響範囲を明示化する
- 複雑度メトリクスや依存関係分析などを用い、定量的にリスクを評価する
- 新規開発と負債返済のバランスを取るため、負債返済スプリントや改善バッファを定常化する
- 負債のリスクスコアをアーキテクチャレビューに組み込み、優先度を定期的に見直す
- 負債の推移をポートフォリオとして追跡し、組織的な改善トレンドを評価する
- AIや自動解析ツールを活用し、検出・分類・トレンド可視化を継続的に行う

### 関連する原則
- ADR-0008: Data Contract & Schema Evolution（スキーマ変更による負債の最小化）
- ADR-0009: Lifecycle-Aware Architecture（ライフサイクル管理による負債の予防）
- ADR-0007: Observability（負債の可視化と継続的なガバナンス）

## Consequences

### Positive
- 技術的負債が定量的に把握され、事業リスクとして認識される
- 返済（リファクタリングや再設計）を投資判断として扱える
- アーキテクチャガバナンスが実効性あるものになり、継続的改善が促進される
- 組織的な改善トレンドを追跡し、改善文化を醸成できる

### Negative
- 技術的負債の棚卸しと評価に時間とコストが必要
- 負債返済スプリントや改善バッファの確保により、短期的な開発速度が低下する可能性
- 複雑度メトリクスや依存関係分析のツール導入コストが発生

### Mitigation
- AIや自動解析ツールを活用し、棚卸しと評価を自動化
- 負債返済を定常化し、短期的な開発速度低下を最小化
- 継続的なアーキテクチャレビューにより、負債の発生を予防

## Reference
- Architecture Vision: `03_arch-artifacts/arch-vision.md`
- Analysis: `01_working/bd_arch-design/20_analysis/2025-11-05-eosl-technical-debt.md`
- Analysis: `01_working/bd_arch-design/20_analysis/2025-11-06-amount-inconsistency-root-cause.md`
- Analysis: `01_working/bd_arch-design/20_analysis/2025-11-06-system-integration-issues.md`
- Principle: `03_arch-artifacts/principles/principle-010-manage-technical-debt.md`

