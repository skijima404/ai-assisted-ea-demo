# ADR-0006: Security First (セキュリティファースト)

## Status
Approved

## Context

レガシープロセスや旧式システムに起因する複数のセキュリティリスクが存在しています。

- 退職後も従業員アカウントが速やかに無効化されず、アクセスが継続される場合がある。
- HRデータベースは退職時にアカウントを無効化するが、一方向同期によるカフェテリアシステムへの反映が遅延する。
- ID統合には退職者の削除フローがなく、一方向同期（HR → カフェテリア）である。
- 物理的なIDカード回収が遅れ、退職後もカフェテリアへのアクセスが可能な状態が続く。
- OS、ミドルウェア、データベースはすべてEOSL（End of Service Life）であり、セキュリティパッチが提供されず既知の脆弱性が残存している。
- バージョン間の破壊的変更によりアップグレードが困難である。

重大なインシデントは発生していないものの、これらの問題は継続的なセキュリティリスクを孕み、安全かつ透明なデータ共有を促進するアーキテクチャビジョンと矛盾しています。

## Decision

アーキテクチャ設計およびモダナイゼーションの順序において、セキュリティを最優先する**Security First（セキュリティファースト）**の原則を採用します。具体的には、新機能や強化を導入する前に、自動化されたアカウント無効化と安全な統合メカニズムの実現に注力します。

主なポイントは以下の通りです：

- 退職トリガーによるアカウント自動無効化を実装し、手動遅延を排除する。
- 認証・認可システムを安全に統合し、REST APIやイベント駆動型同期の検討を行う。
- EOSL対応および認証の中央集約は、セキュリティ目標を支える重要な文脈として位置づけるが二次的な扱いとする。
- セキュリティの可観測性、監視、定期的なリスク評価をシステム進化の過程で優先的に実施する。

## Implications

- 退職時にタイムリーかつ確実なアカウント無効化を自動化する仕組みを導入する。
- セキュリティイベントの検知と対応のための可観測性および監視機能を整備する。
- セキュリティリスクおよびシステムコンプライアンスの定期的な評価を実施する。
- 機能拡張よりも先にセキュリティ改善を優先したモダナイゼーション計画を策定する。
- 既存インフラと連携可能な安全な認証・認可システムの評価および統合を行う。

## Consequences

### Positive
- 退職後のアクセス残存や旧式ソフトウェアに起因するセキュリティリスクの体系的な低減。
- セキュリティポリシーおよび安全なデータ共有を目指すアーキテクチャビジョンとの整合性向上。
- 監視と評価によるセキュリティ状況の可視化強化。
- 認証・認可の中央集約によるガバナンスおよび管理性の向上。

### Negative
- 自動化、統合、監視基盤への初期投資が必要となる。
- レガシーシステムおよびワークフローの移行に伴う労力とコストがかかる。
- 継続的なセキュリティ監視運用体制の確立が求められる。

## 関連原則
- ADR-0002: Real-time Data Processing（リアルタイムでのアカウント無効化）
- ADR-0003: Event Driven Architecture（退職イベントの迅速な連携）

## Reference
- Architecture Vision: `03_arch-artifacts/arch-vision.md`
- Analysis: `01_working/bd_arch-design/20_analysis/an-005-id-lifecycle-management-broken.md`
- Analysis: `01_working/bd_arch-design/20_analysis/an-001-upgrade-path-is-blocked-by-mw-compatibility.md`
- Principle: `03_arch-artifacts/principles/principle-006-security-first.md`

