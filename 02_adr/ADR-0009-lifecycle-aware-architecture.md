# ADR-0009: Lifecycle-Aware Architecture (ライフサイクルを意識した設計)

## Status
Accepted

## Context

### 問題の背景

現状のシステムは、初期導入時の要件に最適化されすぎており、時間の経過とともにメンテナンスやアップグレードが困難になっている。

**EOSL問題の深刻化**:
- OS、MW、DBがすべてEOSLバージョン
- セキュリティパッチが提供されず、既知の脆弱性に対して無防備な状態が継続
- バージョン間の破壊的変更により、モノリス全体のアップグレードが必要

**モノリス構造の影響**:
- OS・MW・DBなどのバージョン依存が強く、個別更新ができない
- コンポーネント間の密結合により、一部のアップグレードが全体に影響する
- 技術的負債が蓄積し、改修が困難になっている

**技術的負債の原因**:
- 初期開発時に割引のユースケースがなく、後から追加する際に設計変更が必要
- 初期開発メンバーが退職し、知識が喪失している
- コードの複雑性により、改修のリスクが高い

**ライフサイクル管理の欠如**:
- 導入時点の要件にのみ最適化され、保守・アップグレード・廃棄を考慮していない
- 技術スタックの更新サイクルが可視化されていない
- EOSLリスクが定期的に評価されていない

**ビジョンとの関連**:
- アーキテクチャビジョン「3. 柔軟で持続可能なシステム基盤の実現 - 変化に強い仕組み」
- アーキテクチャビジョン「4. 組織と文化の一体的な成長 - 継続的な改善文化の醸成」

## Decision

**「Lifecycle-Aware Architecture (ライフサイクルを意識した設計)」原則を採用する**

システムおよびコンポーネントは導入時点の要件だけでなく、保守・アップグレード・廃棄を含むライフサイクル全体を見据えて設計する。ライフサイクルに応じた更新容易性を確保し、技術的負債やEOSLリスクを最小化する。

### 実装への影響（Implications）
- コンポーネントは独立したライフサイクルを持ち、個別にデプロイ・更新・廃止できる構造とする
- 使用する外部製品（OS、MW、DB等）はLTS（Long Term Support）ポリシーを基準に選定する
- 技術スタックの更新サイクルを可視化し、アーキテクチャ設計時点で更新計画を明示する
- 年次または半期ごとに技術スタックの棚卸しを実施し、EOSLリスクを定期的に評価する
- アップグレードや置換を容易にするため、コンポーネント間の依存関係を最小化する
- 継続的なアーキテクチャレビューにより、ライフサイクル計画と実装の乖離を検出する

### 関連する原則
- ADR-0002: Real-time Data Processing（技術スタックの更新容易性）
- ADR-0004: Microservices Architecture（コンポーネント単位の独立したライフサイクル）
- ADR-0007: Observability（ライフサイクルの可視化と継続的なガバナンス）

## Consequences

### Positive
- コンポーネント単位での独立した更新や段階的モダナイゼーションが可能
- EOSLリスクを定期的に評価し、計画的に対応できる
- 技術的負債を最小化し、継続的な健全性を維持
- LTSポリシーにより、長期的なサポートが確保される

### Negative
- ライフサイクル管理のための運用コストが発生
- 技術スタックの棚卸しと評価に時間が必要
- 継続的なアーキテクチャレビューの体制構築が必要

### Mitigation
- 年次または半期ごとの棚卸しをプロセス化し、継続的に実施
- AIや自動解析ツールを活用し、検出・分類・トレンド可視化を継続的に行う
- マイクロサービス化により、コンポーネント単位での更新を容易にする

## Reference
- Architecture Vision: `03_arch-artifacts/arch-vision.md`
- Analysis: `01_working/bd_arch-design/20_analysis/2025-11-05-eosl-technical-debt.md`
- Principle: `03_arch-artifacts/principles/principle-009-lifecycle-aware-architecture.md`

