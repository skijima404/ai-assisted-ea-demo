---
date: 2025-11-07
tags: [raw]
---

# Raw Note

## 気づき (Observation)  
社食システムに内包されている機能群の切り出し難易度
- ユーザープロファイル (users)
  - 切り出すだけならそれほど難易度は高くない
    - データ入力は限定的。
      - 入社の際に人事システムの登録ユーザーから情報を取得してデータ更新している。現在バッチ。
      - 異動時の更新不要
      - 退職はないが今後はアカウント無効化 --> 削除
      - 一部ユーザー情報の画面入力はあるが、月に数回あるかないか
    - 画面で表示する際に参照されている
      - ユーザー表示名やメールアドレス
      - アクセスコントロール
- メニュー (menu)
  - 切り出すだけなら難易度はそれほど高くない
    - 入力は社食の栄養士さんが実施、1週間に一度などまとめて
      - Writeが移行難易度を上げるなら、一時的にWriteを止め、Excel等で受け取ったデータをこちらがSQLで処理することで対応可能
  - 画面からの呼び出しでよく呼ばれる
- 決済履歴 (payments)
  - 切り出し難易度それなりに
    - 入力は多いが決済端末からのみ
      - 入力のみ、Value Objectなので更新されない
    - 多機能からの参照あり
      - 内部の利用明細、請求台帳 (現在はプロシージャ)
        - Target Architectureではこの2つは人事システム側に移動、イベント連携の予定
- 利用明細 (transactions)
  - 概要のみ記載。Baselineでは厳密な transactions テーブルは存在しない。
  - コンビニ側の `convini_receipt_items` と、社食側の `receipts` / `receipt_items` が非対称なため、結合は弱い（詳細は deep-dive を参照）。
  - Target Architecture では、社食＋コンビニ両方の明細を統合する役割となり、移行時の検算ロジックが大きく変更される。
  - ※詳細分析 → `2025-11-07-transactions-deep-dive.md`
- 請求台帳 (bills)
  - 現在はインプットがCSVに限定されているので、切り出すことはそれほど難しくない
  - Target Architectureでは利用明細との依存度高め
    - 検算のデータソースが利用明細に切り替わる

キモは利用明細と依存関係のあるものの順序整理。
逆にメニューは移行しやすそうなので、どのタイミングにもできそう。
最初に切り出してコントラクトテストの習熟素材にしても良いかも。


## 疑問 (Question)
- 特になし

## 次アクション (Next Step)
- 利用明細の詳細シミュレーション