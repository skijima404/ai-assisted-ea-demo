---
id: an-005
date: 2025-11-06
title: id-lifecycle-management-broken
status: draft
tags: [analysis, identity, lifecycle, hr-integration]
---

# Incident (Observed Behavior)
- 退職済みの従業員が、IDカードを返却しに来た際に社食を利用できてしまった事例が複数確認された
- 人事システム（HRDB）では退職処理が既に行われているにもかかわらず、社食システム側のユーザーデータは有効のまま残存していた
- 社食・人事双方で「どちらが削除すべきか」の問い合わせが発生し、対応工数が散発的に発生している
- 頻度は低いものの、**IDを使った認証主体が退職後も存続しているというセキュリティ上の重大リスク**が看過されている

# Conclusion
**HRDB → 社食システムの同期が一方向かつ“作成のみ”であり、退職・無効化・削除といった ID ライフサイクル管理が成立していないため、退職後も社食アプリで認証・決済が可能な状態となっている。**

# Assumptions / Hypotheses
- HRDB は正しく退職処理を行っており、従業員レコードは無効化されている前提
- 社食システム側には「退職データの取り込み」「退職者の無効化／削除」を行う仕組みが存在しない
- ID連携は“初回登録（プロビジョニング）”に偏っており、“ライフサイクル管理（無効化・削除）”が考慮されていない
- 多くの現場で「頻度が低いから深刻ではない」と判断され、リスク評価が行われていない

# Reasoning
- HRDB の退職処理は正しく行われている  
  → 退職者に関する“真実のソース”は人事システム側
- しかし社食システムはその退職情報を取り込んでいない  
  → 同期が**片方向＆作成のみ**
- 同期方式が「イベント駆動のプロビジョニング」ではなく  
  **“ファイル連携＋新規のみ”** のため、  
  削除・無効化イベントが伝搬しない
- 結果として、**退職者データが永続的に残り続け、IC カード決済という物理的な認証手段が利用可能なまま放置される**
- 頻度は低いが、インパクトは大きく、通常のリスク管理の観点では「高リスク」と扱うべき事象が見逃されている

# Implications
- ID連携は“初回登録”だけでなく、**無効化・削除・更新**を含むフルライフサイクルで設計する必要がある
- Transition Architecture では  
  - HRDB を“真実のソース”として扱う  
  - 退職データ取り込みとアカウント無効化処理を明示的に導入  
  - 社食システムの ID ストアを最低限化（もしくは外部参照化）  
 の方向性が必須
- セキュリティの観点では「IDが生きていること」自体が脅威となるため、  
  **社員IDを認証要素とするサービス全体でライフサイクル統合**を検討すべき
- 組織面では、  
  - 人事・社食・セキュリティチーム間でライフサイクル連携の責任境界を定義  
  - ID無効化を“例外処理”ではなく“業務フロー”に組み込む  
 が必要

# Observations
- HRDB では退職処理が正常に行われている  
- 社食ユーザーは無効化されていない  
- 社食と人事の同期方式は“ファイル連携＋作成のみ”  
- 退職反映が翌週になるケースが既に報告されている

# Evidence
- raw-notes/2025-11-06-ex-employee-badge.md
- raw-notes/2025-11-06-hr-retirement-process.md